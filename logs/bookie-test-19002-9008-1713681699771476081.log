2024-04-21 14:41:39 [INFO] start recovery process
2024-04-21 14:41:39 [INFO] recovery: meet segment t-seg. ElapsedTime: 1m14.863554187s
2024-04-21 14:41:39 [INFO] ZooKeeper connected to 127.0.0.1:18001
2024-04-21 14:41:39 [INFO] ZooKeeper authenticated: id=72057594512080929, timeout=4000
2024-04-21 14:41:39 [INFO] ZooKeeper re-submitting `0` credentials after reconnect
2024-04-21 14:41:39 [INFO] RPC is handled in path: /_go_rpc_127_0_0_1_19002 and debug path: /debug/gorpc_127.0.0.1:19002
2024-04-21 14:41:39 [INFO] Bookie state is set to Running
2024-04-21 14:41:40 [INFO] Bookie [9008] starts running in main loop...
2024-04-21 14:41:40 [INFO] With config:
 {
  "ReplicateNumber": 3,
  "MinimumReplicaNumber": 2,
  "SegmentMaxSize": 33554432,
  "StorageMaxSize": 268435456,
  "StorageDirectoryPath": "/home/hoo/Filebase/project/pigeonmq/cmd/pigeonmq-bookie/storages/storage2",
  "LogFilePath": "/home/hoo/Filebase/project/pigeonmq/logs",
  "PermissibleDowntime": 3000000000,
  "ZooKeeperClusterAddresses": [
    "127.0.0.1:18001"
  ],
  "ZooKeeperConnectionTimeout": 3000000000,
  "DefaultPeerCommunicationTimeout": 3000000000,
  "IPAddress": "127.0.0.1",
  "Port": 19002,
  "CronTimer": 10000000000,
  "RetentionHours": 604800000000000
}
2024-04-21 14:41:40 [INFO] Bookie received RPC CreateBackupSegment, args=&{t-seg}
2024-04-21 14:41:40 [INFO] Bookie send leader crash event. event={leader crash 1 {t-seg}}
2024-04-21 14:41:40 [INFO] Bookie handled RPC CreateBackupSegment: error=<nil>
2024-04-21 14:41:40 [INFO] handle event {Description:leader crash eType:1 args:{segmentName:t-seg}}
2024-04-21 14:41:40 [INFO] elected leader 127.0.0.1:19001
2024-04-21 14:41:40 [INFO] Bookie send leader crash event. event={leader crash 1 {t-seg}}
2024-04-21 14:41:40 [INFO] handle event {Description:leader crash eType:1 args:{segmentName:t-seg}}
2024-04-21 14:41:40 [INFO] elected leader 127.0.0.1:19001
2024-04-21 14:41:40 [INFO] Bookie send leader crash event. event={leader crash 1 {t-seg}}
2024-04-21 14:41:40 [INFO] handle event {Description:leader crash eType:1 args:{segmentName:t-seg}}
2024-04-21 14:41:40 [INFO] elected leader 127.0.0.1:19001
2024-04-21 14:41:40 [INFO] Bookie send leader crash event. event={leader crash 1 {t-seg}}
2024-04-21 14:41:40 [INFO] handle event {Description:leader crash eType:1 args:{segmentName:t-seg}}
2024-04-21 14:41:40 [INFO] elected leader 127.0.0.1:19001
2024-04-21 14:41:40 [INFO] Bookie send leader crash event. event={leader crash 1 {t-seg}}
2024-04-21 14:41:40 [INFO] handle event {Description:leader crash eType:1 args:{segmentName:t-seg}}
2024-04-21 14:41:40 [INFO] elected leader 127.0.0.1:19001
2024-04-21 14:41:40 [INFO] Bookie send leader crash event. event={leader crash 1 {t-seg}}
2024-04-21 14:41:40 [INFO] handle event {Description:leader crash eType:1 args:{segmentName:t-seg}}
2024-04-21 14:41:40 [INFO] Bookie received RPC AppendBackupSegment, segmentName=t-seg, dataLen=1024
2024-04-21 14:41:40 [INFO] elected leader 127.0.0.1:19001
2024-04-21 14:41:40 [INFO] Bookie send leader crash event. event={leader crash 1 {t-seg}}
2024-04-21 14:41:40 [INFO] handle event {Description:leader crash eType:1 args:{segmentName:t-seg}}
2024-04-21 14:41:40 [INFO] Bookie hanlded AppendBackupSegment, error=<nil>
2024-04-21 14:41:40 [INFO] elected leader 127.0.0.1:19002
2024-04-21 14:41:40 [INFO] Bookie received RPC AppendBackupSegment, segmentName=t-seg, dataLen=1024
2024-04-21 14:41:40 [INFO] Bookie hanlded AppendBackupSegment, error=<nil>
2024-04-21 14:41:40 [INFO] Bookie received RPC AppendBackupSegment, segmentName=t-seg, dataLen=1024
2024-04-21 14:41:40 [INFO] Bookie hanlded AppendBackupSegment, error=<nil>
2024-04-21 14:41:40 [INFO] Bookie received RPC AppendBackupSegment, segmentName=t-seg, dataLen=1024
2024-04-21 14:41:40 [INFO] Bookie hanlded AppendBackupSegment, error=<nil>
2024-04-21 14:41:43 [INFO] Bookie send follower crash event.
2024-04-21 14:41:43 [INFO] handle event {Description:follower crash eType:2 args:{segmentName:t-seg beforeFollowers:[bookie0000000025 bookie0000000027] currentFollowers:[bookie0000000025 bookie0000000027]}}
2024-04-21 14:41:43 [INFO] handleEventFollowerUpdate, segmentBookies map[bookie0000000025:0xc000238e10 bookie0000000027:0xc00060c510](len=2) 
2024-04-21 14:41:43 [WARN] Some follower crashed but comes back.
2024-04-21 14:41:45 [INFO] Bookie received RPC ReadSegment, args={t-seg 16 1024}
2024-04-21 14:41:45 [INFO] Bookie handled RPC ReadSegment, error=<nil>
2024-04-21 14:41:45 [INFO] Bookie received RPC ReadSegment, args={t-seg 1040 1024}
2024-04-21 14:41:45 [INFO] Bookie handled RPC ReadSegment, error=<nil>
2024-04-21 14:41:45 [INFO] Bookie received RPC ReadSegment, args={t-seg 2064 1024}
2024-04-21 14:41:45 [INFO] Bookie handled RPC ReadSegment, error=<nil>
2024-04-21 14:41:45 [INFO] Bookie received RPC ReadSegment, args={t-seg 3088 1024}
2024-04-21 14:41:45 [INFO] Bookie handled RPC ReadSegment, error=<nil>
2024-04-21 14:41:45 [INFO] Bookie [9008] shutting down...
2024-04-21 14:41:45 [INFO] Bookie state is set to Stopped
2024-04-21 14:41:45 [ERROR] watchSegmentPeersBG meet error zk: connection closed
2024-04-21 14:41:45 [ERROR] watchSegmentPeersBG meet error zk: connection closed
2024-04-21 14:41:45 [INFO] ZooKeeper recv loop terminated: EOF
2024-04-21 14:41:45 [INFO] ZooKeeper send loop terminated: <nil>
2024-04-21 14:41:45 [INFO] Bookie [9008] shut down successfully
